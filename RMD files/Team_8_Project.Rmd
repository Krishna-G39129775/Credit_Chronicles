---
title: "Team 8: Credit Chronicles "
author: "Members: Sai Krishna ,Gourab Mukherjee, Tulasi"
#date: "`r Sys.Date()`"
output:
  html_document:
    css: custom_theme.css
    code_folding: hide
---


```{r init, include=F}
# The package "ezids" (EZ Intro to Data Science) includes some helper functions we developed for the course. 
# Some of the frequently used functions are loadPkg(), xkabledply(), xkablesummary(), uzscale(), etc.
# You will need to install it (once) from GitHub.
# library(devtools)
# devtools::install_github("physicsland/ezids")
# Then load the package in your R session.
library(ezids)
```


```{r setup, include=FALSE}
# Some of common RMD options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, message = F)
# Can globally set option for number display format.
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
```
<h1 style="color: RED;"><b>DATA PREPROCESSING</b></h1>
<h1 style="color: white;"><b>LOADING DATASET & CHECKING str():</b></h1>
```{r reading_datafile_credit_card_churn.csv  , include=TRUE}
library(readr)
credit_card <- read.csv("credit_card.csv")
print(str(credit_card))


```
<h1 style="color: white;"><b>DIMENSIONS OF DATA: </b></h1>
```{r}
dim(credit_card)
```
<h1 style="color: white;"><b>SUMMARY OF DATASET:</b></h1>
```{r}
summary(credit_card)
```
<h1 style="color: white;"><b>COLUMN NAMES IN THE DATASET:</b></h1>
```{r Column_names , include=TRUE}
column_names <- colnames(credit_card)
last_two_columns <- tail(column_names, 2)
print(column_names)

```

<h1 style="color: white;"><b>AFTER DROPING UNNECESSARY COLUMNS:</b></h1>
```{r Dropping_last_two_columns_to_get_final_dataframe , include=TRUE}

credit_card_final <- subset(credit_card,select = !colnames(credit_card) %in% last_two_columns)
print(colnames(credit_card_final))

```
<h1 style="color: white;"><b>CHECKING FOR NULL VALUES</b></h1>
```{r}
null_counts <- colSums(is.na(credit_card_final))
print(null_counts)
```

<h1 style="color: white;"><b>REPLACING SPACES WITH NA AND CHECKING FOR NULL VALUES OR UNFILLED VALUES </b></h1>
```{r}
credit_card_final[credit_card_final == " "] <- NA
null_counts1 <- colSums(is.na(credit_card_final))
print(null_counts1)
```

<h1 style="color: RED;"><b>EDA --> "Exploratory Data Analysis"</b></h1>

<h1 style="color: RED;"><b>EDA --> "Histograms - Utilized to gain an understanding of the distribution of continuous variables, providing insights into the central tendency, variability, and overall shape of the dataset's distribution.Univariate Analysis - Examining individual variables in isolation.
"</b></h1>

```{r 1outliers in credit limit , include=TRUE}
library(tidyverse)

character_columns <- credit_card_final%>% select_if(is.character)
#Analysis of all the numeric columns
numeric_columns <- names(credit_card_final %>%
  select_if(is.numeric) %>%
  select(-CLIENTNUM))



variable_columns <- c(numeric_columns)

col_names <- c(numeric_columns)

df <- credit_card_final %>%
  select(all_of(variable_columns)) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Value")

df$Variable <- factor(df$Variable, levels = variable_columns, labels = col_names)

p <- ggplot(df, aes(x = Value)) + 
  geom_histogram(aes(y = ..count..), fill = '#66c2a5', color = '#004d40', bins = 30) +
  geom_freqpoly(color = "#e34a33", size = 1) +
  facet_wrap(~ Variable, scales = "free", ncol = 2) +
  theme_minimal() + 
  labs(title = "Histograms of Numeric Variables", y = "Frequency") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

options(
  repr.plot.width = 10,    # Adjust the width
  repr.plot.height = 6    # Adjust the height
)


print(p)


```

```{r histogram plot for Avg_Utilization_Ratio , include=TRUE}
library(dplyr)
library(ggplot2)

credit_card_final_without_unknown <- subset(credit_card_final, Income_Category!= unknown)
histogram_plot <- ggplot(credit_card_final_without_unknown, aes(x = Avg_Utilization_Ratio, fill = Income_Category)) +
  geom_histogram(binwidth = 0.05, color = "black") +  
  facet_wrap(~Income_Category, scales = "free", ncol = 3) +
  labs(title = 'Histogram of Avg_Utilization_Ratio by Income Category') +
  theme_minimal()


print(histogram_plot)
```

```{r transaction_behavior(Average utilization ratio and income category) , include=TRUE}


library(dplyr)
library(ggplot2)

# Grouping according to income category and calculating the aggregate of average utilization ratio of each income category in the dataframe
Income_category_and_average_utilization <- credit_card_final_without_unknown %>% 
  group_by(Income_Category) %>%
  summarise(Avg_Utilization_Ratio = mean(Avg_Utilization_Ratio))

# Defining the order of the columns (lowest to highest)
cols <- c('Less than $40K', '$40K - $60K', '$60K - $80K', '$80K - $120K', '$120K +')


plot <- ggplot(Income_category_and_average_utilization, aes(x = Income_Category, y = Avg_Utilization_Ratio, fill = Income_Category)) +
  geom_bar(stat = "identity") +  # Use geom_bar for a bar plot
  scale_x_discrete(limits = cols) +
  labs(title = 'Average Card Utilization Ratio with respect to Income Category') +
  theme_minimal()

print(Income_category_and_average_utilization)
# Display the plot
print(plot)


```
**The give bar plot implies that there is an inverse relationship between income range and credit card utilization, specifically, a decrease in credit card utilization as income range increases.**
**In simpler terms, it means that people with higher income ranges tend to use a smaller proportion of their available credit on their credit cards compared to people with lower income ranges. This suggests that individuals with higher incomes may have more financial stability and may not need to rely as heavily on credit card debt, resulting in a lower credit card utilization ratio.**




